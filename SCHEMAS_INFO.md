# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Å—Ö–µ–º–∞—Ö

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è

### –ó–∞–¥–∞–Ω–∏–µ 1: –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–°–æ–∑–¥–∞–Ω–æ 5 —Å—Ö–µ–º –≤ —Ñ–æ—Ä–º–∞—Ç–µ `.drawio` –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —ç–≤–æ–ª—é—Ü–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:

#### 1. `schema1_sharding.drawio` - –®–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ MongoDB
**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- pymongo-api - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- mongos_router - –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤
- configSrv - —Å–µ—Ä–≤–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- shard1, shard2 - 2 —à–∞—Ä–¥–∞ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

**–¶–µ–ª—å:** –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É 2 —à–∞—Ä–¥–∞–º–∏.

---

#### 2. `schema2_replication.drawio` - –†–µ–ø–ª–∏–∫–∞—Ü–∏—è
**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ —Å—Ö–µ–º—ã 1
- **Replica Set shard1:**
  - shard1-1 (PRIMARY)
  - shard1-2 (SECONDARY)
  - shard1-3 (SECONDARY)
- **Replica Set shard2:**
  - shard2-1 (PRIMARY)
  - shard2-2 (SECONDARY)
  - shard2-3 (SECONDARY)

**–¶–µ–ª—å:** –ü–æ–≤—ã—à–µ–Ω–∏–µ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é. –ö–∞–∂–¥—ã–π —à–∞—Ä–¥ –∏–º–µ–µ—Ç 3 —Ä–µ–ø–ª–∏–∫–∏.

---

#### 3. `schema3_caching.drawio` - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Redis
**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ —Å—Ö–µ–º—ã 2
- **redis** - —Å–µ—Ä–≤–µ—Ä –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–¶–µ–ª—å:** –ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ MongoDB.

---

#### 4. `schema4_api_gateway.drawio` - API Gateway –∏ Service Discovery
**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ —Å—Ö–µ–º—ã 3
- **nginx** - API Gateway –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏
- **consul** - Service Discovery –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
- **3 –∏–Ω—Å—Ç–∞–Ω—Å–∞ pymongo-api** (–≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏

**–¶–µ–ª—å:** –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ–º —Å–µ—Ä–≤–∏—Å–æ–≤.

---

#### 5. `schema5_final_with_cdn.drawio` - –ò—Ç–æ–≥–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å CDN (–ò–¢–û–ì–û–í–ê–Ø –î–õ–Ø –ü–†–û–í–ï–†–ö–ò)
**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ —Å—Ö–µ–º—ã 4
- **3 CDN –Ω–æ–¥—ã** –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö (–ï–≤—Ä–æ–ø–∞, –ê–∑–∏—è, –°–®–ê)
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤
- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç** (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, CSS, JS)

**–¶–µ–ª—å:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–æ—Å—Ç–∞–≤–∫–∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤ —Ä–∞–∑–Ω—ã—Ö –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö.

**–ò–¢–û–ì–û–í–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø:**
- ‚úÖ 3 CDN –Ω–æ–¥—ã
- ‚úÖ 1 API Gateway (Nginx)
- ‚úÖ 1 Service Discovery (Consul)
- ‚úÖ 3 API –∏–Ω—Å—Ç–∞–Ω—Å–∞ (pymongo-api)
- ‚úÖ 1 Redis (–∫–µ—à)
- ‚úÖ 1 Mongos Router
- ‚úÖ 1 Config Server
- ‚úÖ 6 MongoDB –Ω–æ–¥ (2 —à–∞—Ä–¥–∞ √ó 3 —Ä–µ–ø–ª–∏–∫–∏)

---

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å Docker Compose

–í—Å–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/c/VirtualBoxFolder/`:

### 1. `mongo-sharding/` (–ó–∞–¥–∞–Ω–∏–µ 2)
- –ë–∞–∑–æ–≤–æ–µ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å 2 —à–∞—Ä–¥–∞–º–∏
- 1000 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã: 492 (shard1) + 508 (shard2)
- –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ

### 2. `mongo-sharding-repl/` (–ó–∞–¥–∞–Ω–∏–µ 3)
- –®–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ + –†–µ–ø–ª–∏–∫–∞—Ü–∏—è
- 2 —à–∞—Ä–¥–∞, –∫–∞–∂–¥—ã–π —Å 3 —Ä–µ–ø–ª–∏–∫–∞–º–∏ (PRIMARY + 2 SECONDARY)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π failover –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ PRIMARY
- –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ

### 3. `sharding-repl-cache/` (–ó–∞–¥–∞–Ω–∏–µ 4)
- –®–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ + –†–µ–ø–ª–∏–∫–∞—Ü–∏—è + Redis –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- API –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `cache_enabled: true`
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ (<100ms)
- –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ

### 4. `mongo-full-stack/` (–ó–∞–¥–∞–Ω–∏—è 5 –∏ 6)
- –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- Nginx API Gateway –Ω–∞ –ø–æ—Ä—Ç—É 80
- Consul –¥–ª—è Service Discovery –Ω–∞ –ø–æ—Ä—Ç—É 8500
- 12 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∑–∞–ø—É—â–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ

---

## –ö–∞–∫ –æ—Ç–∫—Ä—ã—Ç—å —Å—Ö–µ–º—ã

1. –°–∫–∞—á–∞—Ç—å [draw.io Desktop](https://github.com/jgraph/drawio-desktop/releases) –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [https://app.diagrams.net/](https://app.diagrams.net/)
2. –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª—ã `schema*.drawio` –≤ draw.io
3. –í—Å–µ —Å—Ö–µ–º—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –ª–µ–≥–µ–Ω–¥—É —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

---

## –î–ª—è —Ä–µ–≤—å—é–µ—Ä–∞

**–ò—Ç–æ–≥–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:** `schema5_final_with_cdn.drawio`

–≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–æ –≤—Å–µ–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –∏–∑ –∑–∞–¥–∞–Ω–∏–π 1-6:
- ‚úÖ –®–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ (2 —à–∞—Ä–¥–∞)
- ‚úÖ –†–µ–ø–ª–∏–∫–∞—Ü–∏—è (3 —Ä–µ–ø–ª–∏–∫–∏ –Ω–∞ –∫–∞–∂–¥—ã–π —à–∞—Ä–¥)
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (Redis)
- ‚úÖ API Gateway (Nginx) –∏ Service Discovery (Consul)
- ‚úÖ CDN –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö

**–†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–¥–∞–Ω–∏—è 4:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sharding-repl-cache/`
- –ò–ª–∏ `mongo-full-stack/` –¥–ª—è –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

---

## –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

- ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 1: –°–æ–∑–¥–∞—Ç—å 5 —Å—Ö–µ–º
- ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 2: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ MongoDB
- ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 3: –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞—Ä–¥–∞
- ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 4: –î–æ–±–∞–≤–∏—Ç—å Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 5: –î–æ–±–∞–≤–∏—Ç—å API Gateway –∏ Consul
- ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 6: –î–æ–±–∞–≤–∏—Ç—å CDN –Ω–∞ —Å—Ö–µ–º—É
- ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 7: –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º –∫–æ–ª–ª–µ–∫—Ü–∏–π (orders, products, carts)
- ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 8: –í—ã—è–≤–ª–µ–Ω–∏–µ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –≥–æ—Ä—è—á–∏—Ö —à–∞—Ä–¥–æ–≤
- ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 9: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á—Ç–µ–Ω–∏—è —Å —Ä–µ–ø–ª–∏–∫ –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
- ‚úÖ –ó–∞–¥–∞–Ω–∏–µ 10: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Cassandra

**–í—Å–µ –∑–∞–¥–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!**

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ó–∞–¥–∞–Ω–∏—è 7-10 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ —Ñ–∞–π–ª–µ **`ARCHITECTURAL_DOCUMENT.md`** (58 KB).

–î–æ–∫—É–º–µ–Ω—Ç –≤–∫–ª—é—á–∞–µ—Ç:
- üìã –°—Ö–µ–º—ã –∫–æ–ª–ª–µ–∫—Ü–∏–π MongoDB —Å –≤—ã–±–æ—Ä–æ–º shard-–∫–ª—é—á–µ–π
- üìä –ú–µ—Ç—Ä–∏–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –≥–æ—Ä—è—á–∏—Ö —à–∞—Ä–¥–æ–≤
- üîÑ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Read Preferences –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è —Å —Ä–µ–ø–ª–∏–∫
- üöÄ –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ Cassandra —Å –º–æ–¥–µ–ª—è–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

---

–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: 16 –æ–∫—Ç—è–±—Ä—è 2025
